<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>üéß SA:MP Radio Manager</title>
    <link rel="stylesheet" href="/static/style.css" />
  </head>
  <body>
    <h1>üìª Panel de Radio SA:MP</h1>

    <section id="create">
      <input
        type="text"
        id="stationName"
        placeholder="Nombre de nueva estaci√≥n"
      />
      <button onclick="createStation()">‚ûï Crear Estaci√≥n</button>
    </section>

    <section id="stations">
      {% for name, songs in stations.items() %}
      <div class="station">
        <h2>{{ name }}</h2>
        <ul>
          {% for song in songs %}
          <li>{{ song }}</li>
          {% endfor %}
        </ul>
        <button onclick="startStream('{{ name }}')">
          ‚ñ∂ Iniciar Transmisi√≥n
        </button>
        <button onclick="stopStream('{{ name }}')">‚èπ Detener</button>
      </div>
      {% endfor %}
    </section>

    <script>
      async function createStation() {
        const name = document.getElementById("stationName").value;
        if (!name) return alert("Ponle un nombre a la estaci√≥n.");
        const res = await fetch("/create_station", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name }),
        });
        const data = await res.json();
        alert(data.message || data.error);
        location.reload();
      }

      async function startStream(name) {
        const res = await fetch("/start_stream", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name }),
        });
        const data = await res.json();
        alert(data.message || data.error);
      }

      async function stopStream(name) {
        const res = await fetch("/stop_stream", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name }),
        });
        const data = await res.json();
        alert(data.message || data.error);
      }
    </script>
  </body>
</html>
